<h1 align="left">Построение осей инерции твердого тела</h1>

<h3 align="left">Постановка задачи</h3>

Найти, есть ли для множества точек, задающих многогранник, прямые в пространстве (оси), обладающие некоторыми характерными свойствами, которые могут быть полезны для совмещения похожих по конфигурации многогранников, а если такие оси есть, то описать алгоритм их нахождения.

<img align="center" src="https://github.com/vkonov2/Geometry-Projects/blob/4fde689a243a9103e9532d41f1d350239a607b2a/Inertial-Axes-Solid/images/im1.jpg" alt="c" width="500" height="500"/>

<h2 align="left">Немного физики, необходимой для понимания</h2>

Под свободным движением твердого тела понимают движение, происходящее в отсутствие внешних сил. 

Свободное движение твердого тела можно разложить на поступательное движение, в котором все точки тела движутся с такой же скоростью, как и центр масс тела, и вращение вокруг центра масс. В отсутствие внешних сил центр масс движется прямолинейно и равномерно. Для анализа вращения тела целесообразно перейти в систему центра масс, т.е. в инерциальную систему отсчета, в которой центр масс тела покоится, а оси координат имеют неизменные направления в пространстве. В этой системе отсчета движение твердого тела – это вращение вокруг неподвижной точки (вокруг центра масс).

При вращении твердого тела вектор момента импульса $\vec{L}$ (иначе его называют вектором углового момента) пропорционален мгновенной угловой скорости $\vec{w}$, но, вообще говоря, не совпадает с $\vec{w}$ по направлению. Совпадение направлений $\vec{L}$ и $\vec{w}$ будет только тогда, когда угловая скорость направлена вдоль одной из трех взаимно перпендикулярных осей, называемых главными осями инерции тела. Для симметричных тел из однородного материала главные оси инерции совпадают с осями симметрии тела. Например, в случае прямоугольного параллелепипеда главные оси инерции проходят через геометрический центр параллельно ребрам. Моменты инерции тела относительно проходящих через центр масс главных осей называются главными центральными моментами инерции.

Свободное вращение твердого тела вокруг главных осей инерции, когда векторы $\vec{L}$ и $\vec{w}$ совпадают по направлению, происходит очень просто. В самом деле, в отсутствие моментов внешних сил сохраняется вектор момента импульса $\vec{L}$. Отсюда сразу следует, что сохраняется направление вектора угловой скорости в пространстве и сохраняется величина угловой скорости. Поэтому главные оси инерции называют еще \blue{осями свободного вращения} тела. Если твердое тело раскручено вокруг одной из этих осей, оно и дальше просто равномерно вращается вокруг оси, направление которой в пространстве не изменяется.

Возникает вопрос: возможен ли для произвольного твердого тела случай, когда векторы $\vec{L}$ и $\vec{w}$ совпадают? Ответ - да, т.е. для всякого тела и любой точки $O$ имеются по крайней мере три взаимно перпендикулярных направления $\vec{w}$ (три взаимно перпендикулярные оси вращения), для которых направления $\vec{L}$ и $\vec{w}$ совпадают - это и есть **главные оси инерции** тела.

<img align="center" src="https://github.com/vkonov2/Geometry-Projects/blob/4fde689a243a9103e9532d41f1d350239a607b2a/Inertial-Axes-Solid/images/im2.jpg" alt="c" width="500" height="500"/>

<h2 align="left">Теория о геометрии масс тела</h2>

<h3 align="left">Центр масс и введение основных понятий</h3>

Пусть мы имеем твердое тело $G$ массой $M$ - имеем представление в виде $n$ точек. Пусть мы имеем неподвижную прямоугольную систему координат $O_{\text{н}}X_{\text{н}}Y_{\text{н}}Z_{\text{н}}$.

Для начала найдем центр масс твердого тела. 
Так как мы имеем дело с везде плотным телом, то, рассматривая его границу будем рассматривать сосредоточение масс в центрах масс каждой грани, причем массу каждой грани будем считать пропорциональной ее площади. Более подробно: пусть грань $\Gamma_i$ состоит из вершин $P_1, \dots, P_m$, тогда центр масс данной грани однозначно находится через координаты этих точек - получаем массив центр масс граней $P_{\Gamma_i}$. Далее найдем площадь грани $\Gamma_i$ и всех остальных, и пусть $S$ равно сумме площадей всех граней, тогда масса, которую мы будем класть в найденный центр масс грани $\Gamma_i$, будет равна отношению площади грани $\Gamma_i$ к $S$, умноженному на общую массу $M$:
$$m_{\Gamma_i} = \frac{S_{\Gamma_i}}{S} M \eqno(1)$$
Тогда центр масс всего тела $O_G$ можно найти по известной формуле:
$$\overline{r_{O_G}} = \dfrac{\underset{i}{\overset{}{\sum}}m_{\Gamma_i} \overline{r_{P_{\Gamma_i}}}}{M}\eqno(2)$$
где суммирование проходит по всем граням тела. Теперь нам удобно будет рассматривать неподвижную систему координат $O_GXYZ$ с центром в точке $O_G$, получающуюся параллельным переносом из $O_{\text{н}}X_{\text{н}}Y_{\text{н}}Z_{\text{н}}$ на вектор $O_{\text{н}}O_G$.

Исходя из поставленной задачи, будем искать оси (прямые), проходящие церез центр масс твердого тела, удовлетворяющие определенным свойствам, которые укажем далее. Таким образом, ищем прямую, проходящую через точку $O_G$ в направлении $(x_u, y_u, z_u)$. Воспользуемся представлением направляющего вектора через направляющие косинусы (это косинусы углов, которые вектор образует с положительными полуосями координат). Имеем следующие формулы:
$$\cos{\alpha} = \frac{x_u}{\sqrt{x_u^2 + y_u^2 + z_u^2}}, \cos{\beta} = \frac{y_u}{\sqrt{x_u^2 + y_u^2 + z_u^2}}, \cos{\gamma} = \frac{z_u}{\sqrt{x_u^2 + y_u^2 + z_u^2}}\eqno(3)$$
Тогда эти косинусы обладают очевидным свойством: $\displaystyle \cos^2{\alpha} + \cos^2{\beta} + \cos^2{\gamma} = 1$. Итак, имеем ось u, задаваемую вектором $(\cos{\alpha}, \cos{\beta}, \cos{\gamma})$ и точкой $O_G$.

По определению **моментом инерции** $J_u$ тела относительно оси $u$ называют выражение
$$J_u = \underset{i}{\overset{}{\sum}}m_{\Gamma_i} r_{\Gamma_i}^2\eqno(4)$$
где $m_{\Gamma_i}$ - масса $i$-й грани тела, $r_{\Gamma_i}$ - расстояние центра масс грани $\Gamma_i$ от оси $u$, суммирование производится по всем граням тела. Момент инерции характеризует распределение массы тела относительно оси.

С помощью декартовой системы координат $OXYZ$, начало которой выбрано в точке $O_G$ оси u с направляющими косинусами $(\cos{\alpha}, \cos{\beta}, \cos{\gamma})$, выражение момента инерции представляется в виде:
$$J_u =J_x \cos^2{\alpha} + J_y \cos^2{\beta} + J_z \cos^2{\gamma} - 2 J_{xy} \cos{\alpha}\cos{\beta} − 2 J_{xz} \cos{\alpha}\cos{\gamma} − 2 J_{yz} \cos{\beta}\cos{\gamma}\eqno(5)$$
где 
$$J_x = \underset{i}{\overset{}{\sum}}m_{\Gamma_i} (y_{\Gamma_i}^2 + z_{\Gamma_i}^2), J_y = \underset{i}{\overset{}{\sum}}m_{\Gamma_i} (x_{\Gamma_i}^2 + z_{\Gamma_i}^2), J_z = \underset{i}{\overset{}{\sum}}m_{\Gamma_i} (x_{\Gamma_i}^2 + y_{\Gamma_i}^2)$$
$$J_{xy} = \underset{i}{\overset{}{\sum}}m_{\Gamma_i} x_{\Gamma_i} y_{\Gamma_i},  J_{xz} = \underset{i}{\overset{}{\sum}}m_{\Gamma_i} x_{\Gamma_i} z_{\Gamma_i},  J_{yz} = \underset{i}{\overset{}{\sum}}m_{\Gamma_i} y_{\Gamma_i} z_{\Gamma_i}$$
осевые и центробежные моменты инерции тела.

Используя векторно-матричную символику для момента инерции, получим:
$$J_u = \begin{Vmatrix} \cos{\alpha} & \cos{\beta} & \cos{\gamma} \end{Vmatrix} \cdot \begin{Vmatrix} J_x & -J_{xy} & -J_{xz} \\ -J_{xy} & J_y & -J_{yz} \\ -J_{xz} & -J_{yz} & J_z \end{Vmatrix} \cdot \begin{Vmatrix} \cos{\alpha} \\ \cos{\beta} \\ \cos{\gamma} \end{Vmatrix} = \overline{e}^T J \overline{e} \eqno(6)$$
где $\overline{e}(\cos{\alpha},\cos{\beta},\cos{\gamma})$ - орт оси $u$, заданный в указанной системе координат своими направляющими косинусами, а симметрическая матрица $\displaystyle J = \begin{Vmatrix} J_x & -J_{xy} & -J_{xz} \\ -J_{xy} & J_y & -J_{yz} \\ -J_{xz} & -J_{yz} & J_z \end{Vmatrix}$ определяет \blue{тензор инерции} тела (тензор второго ранга). 

Свойства тензора инерции:
1) симметричность: $J_{ij} = J_{ji}$
2) положительная определенность: $\forall x, |x| = 1: x^T J x > 0$
3) неравенства для $J_x$, $J_y$, $J_z$:
	$J_z < J_x + J_y$, $J_z > J_x - J_y$.

	Геометрическое толкование: из трех отрезков, длины которых пропорциональны моментам инерции относительно трех перепендикулярных осей, всегда можно построить треугольник.
4) неравенства для $J_{xy}$, $J_{xz}$, $J_{yz}$:
	$J_{xy} \le \frac{J_z}{2}$, $J_{yz} \le \frac{J_x}{2}$, $J_{zx} \le \frac{J_y}{2}$

Изменяя направление оси $u$ и, следовательно,
изменяя направляющие косинусы в выбранной системе координат, по известным компонентам тензора инерции $J$ можно найти момент инерции для любой оси, проходящей через точку $O_G$.

<h3 align="left">Геометрическая интерпретация распределения моментов инерции</h3>

Понятие момента инерции допускает геометрическую интерпретацию распределения моментов инерции относительно осей пучка с центром $O_G$.

Возьмем на оси $u$ точку $M(x, y, z)$ на расстоянии,
равном $\displaystyle \frac{K}{\sqrt{J_u}}$ от точки $O_G$, где $K$ - некоторый размерный коэффициент. Тогда получаем, что:
$$x = \frac{K}{\sqrt{J_u}} \cos{\alpha}, y = \frac{K}{\sqrt{J_u}} \cos{\beta}, z = \frac{K}{\sqrt{J_u}} \cos{\gamma} \eqno(7)$$
Выразим косинусы:
$$\cos{\alpha} = x \frac{\sqrt{J_u}}{K},
\cos{\beta} = y \frac{\sqrt{J_u}}{K}, 
\cos{\gamma} = z \frac{\sqrt{J_u}}{K}$$

Подставляя полученные значения $(7)$ в $(5)$, получаем следующее:
$$J_u = J_x \left(x \frac{\sqrt{J_u}}{K}\right)^2 + J_y \left(y \frac{\sqrt{J_u}}{K}\right)^2 + J_z \left(z \frac{\sqrt{J_u}}{K}\right)^2 − 2 J_{xy} \left(x \frac{\sqrt{J_u}}{K}\right)\left(y \frac{\sqrt{J_u}}{K}\right) − 2 J_{xz}\left (x \frac{\sqrt{J_u}}{K}\right)\left(z \frac{\sqrt{J_u}}{K}\right) − 2 J_{yz} \left(y \frac{\sqrt{J_u}}{K}\right)\left(z \frac{\sqrt{J_u}}{K}\right)$$

После упрощения получаем уравнение поверхности второго порядка:
$$J_x x^2 + J_y y^2 + J_z z^2 − 2 J_{xy} xy − 2 J_{xz} xz − J_{yz} yz = K^2\eqno(8)$$
Эта поверхность является геометрическим местом точек M при всевозможных направлениях оси u. Поскольку момент инерции относительно произвольной оси величина, отличная от нуля (в невырожденном случае строго положительная величина), то поверхность $(8)$ не имеет точек на бесконечности и, значит, является эллипсоидом - **эллипсоидом энерции**.

Выбор осей симметрии эллипсоида инерции в качестве координатных осей позволяет привести уравнение эллипсоида инерции $(8)$ к канонической форме. Оси симметрии эллипсоида инерции, построенного в некоторой точке, называются \blue{главными осями инерции} для этой точки. И тогда в осях $O_G \xi \eta \zeta$, главных для точки $O_G$, выражение момента энереции $J_u$ приобретает вид:
$$J_u =J_{\xi} \cos^2{\alpha} + J_{\eta} \cos^2{\beta} + J_{\zeta} \cos^2{\gamma}\eqno(9)$$
Центробежные моменты инерции для главных осей
обращаются в нуль, т.е. если ось $O_G \xi$ главная, то
$J_{\xi \eta} = J_{\xi \zeta} = 0$. Главные оси инерции, построенные для центра масс тела, называются \blue{главными центральными осями инерции}.

Таким образом, распределение масс тела характеризуется связанными между собой понятиями тензора инерции тела и эллипсоида инерции, и в главных осях тензор инерции имеет диагональный вид.

<h3 align="left">Алгоритм построения главных центральных осей инерции</h3>

Так как направлениям главных осей инерции соответствуют оси симметрии эллипсоида инерции, а значит, и стационарные значения моментов инерции, то задача нахождения направлений главных осей сводится к рассмотрению необходимого условия экстремума выражения $(5)$ при условии:
$$f (\cos{\alpha} , \cos{\beta} , \cos{\gamma} ) = \cos^2{\alpha} + \cos^2{\beta} + \cos^2 {\gamma} − 1 = 0 \eqno(10)$$

Воспользуемся методом неопределенных множителей Лагранжа, тогда задача сводится к рассмотрению необходимого условия экстремума функции:
$$\varphi(\cos{\alpha} , \cos{\beta} , \cos{\gamma}) = J_u (\cos{\alpha} , \cos{\beta} , \cos{\gamma}) - \lambda f (\cos{\alpha} , \cos{\beta} , \cos{\gamma})\eqno(11)$$

Распишем функцию: 
$$\varphi(\cos{\alpha} , \cos{\beta} , \cos{\gamma}) = J_x \cos^2{\alpha} + J_y \cos^2{\beta} + J_z \cos^2{\gamma} - 2 J_{xy} \cos{\alpha}\cos{\beta} − 2 J_{xz} \cos{\alpha}\cos{\gamma} − 2 J_{yz} \cos{\beta}\cos{\gamma} - \lambda (\cos^2{\alpha} + \cos^2{\beta} + \cos^2 {\gamma} − 1)$$

Выпишем условие стационарности функции:
$$\begin{cases}
	\frac{\partial \varphi}{\partial \chi_1} = \frac{\partial J_u}{\partial \chi_1} - \lambda \frac{\partial f}{\partial \chi_1} = 0 \\
	\frac{\partial \varphi}{\partial \chi_2} = \frac{\partial J_u}{\partial \chi_2} - \lambda \frac{\partial f}{\partial \chi_2} = 0 \\
	\frac{\partial \varphi}{\partial \chi_3} = \frac{\partial J_u}{\partial \chi_3} - \lambda \frac{\partial f}{\partial \chi_3} = 0
\end{cases}$$
$$\begin{cases}
	\chi_1 = \cos{\alpha} \\
	\chi_2 = \cos{\beta} \\
	\chi_3 = \cos{\gamma}
\end{cases}$$

Распишем систему:
$$\begin{cases}
	2 J_x \cos{\alpha} - 2 J_{xy} \cos{\beta} - 2 J_{xz} \cos{\gamma} - 2 \lambda \cos{\alpha} = 0 \\
	2 J_y \cos{\beta} - 2 J_{xy} \cos{\alpha} - 2 J_{yz} \cos{\gamma} - 2 \lambda \cos{\beta} = 0 \\
	2 J_z \cos{\gamma} - 2 J_{xz} \cos{\alpha} - 2 J_{yz} \cos{\beta} - 2 \lambda \cos{\gamma} = 0
\end{cases}$$

После сокращений и объединения членов, получаем:
$$\begin{cases}
	(J_x - \lambda) \cos{\alpha} - J_{xy} \cos{\beta} - J_{xz} \cos{\gamma} = 0 \\
	- J_{xy} \cos{\alpha} + (J_y - \lambda) \cos{\beta} - J_{yz} \cos{\gamma} = 0 \\
	- J_{xz} \cos{\alpha} - J_{yz} \cos{\beta} + (J_z - \lambda) \cos{\gamma} = 0
\end{cases}\eqno(12)$$

Таким образом, имеем однородную систему уравнений на косинусы:
$$\begin{pmatrix} 
	J_x - \lambda & -J_{xy} & -J_{xz} \\
	-J_{xy} & J_y - \lambda & -J_{yz} \\
	-J_{xz} & -J_{yz} & J_z - \lambda 
\end{pmatrix} \begin{pmatrix}
	\cos{\alpha} \\ \cos{\beta} \\ \cos{\gamma}
\end{pmatrix} = 0 \eqno(13)$$

Однородная система линейных уравнений $(12)$ относительно $\cos{\alpha}$, $\cos{\beta}$, $\cos{\gamma}$ имеет нетривиальное решение, если детерминант ее равен нулю:
$$det \| J - \lambda E \| = \begin{Vmatrix} 
	J_x - \lambda & -J_{xy} & -J_{xz} \\
	-J_{xy} & J_y - \lambda & -J_{yz} \\
	-J_{xz} & -J_{yz} & J_z - \lambda 
\end{Vmatrix} = 0 \eqno(14)$$

Левая часть равенства $(14)$ представляет собой полином третьей степени относительно $\lambda$. Этот полином имеет три действительных корня, т.к. тензор $J$ симметрический с действительными компонентами.

Умножим каждое из уравнений системы $(12)$ соответственно на $\cos{\alpha}$, $\cos{\beta}$, $\cos{\gamma}$:
$$\begin{cases}
	(J_x - \lambda) \cos^2{\alpha} - J_{xy} \cos{\alpha}\cos{\beta} - J_{xz} \cos{\alpha}\cos{\gamma} = 0 \\
	- J_{xy} \cos{\alpha}\cos{\beta} + (J_y - \lambda) \cos^2{\beta} - J_{yz} \cos{\beta}\cos{\gamma} = 0 \\
	- J_{xz} \cos{\alpha}\cos{\gamma} - J_{yz} \cos{\beta}\cos{\gamma} + (J_z - \lambda) \cos^2{\gamma} = 0
\end{cases}$$

Сложим все три уравнения, получим:
$$\underset{i=1}{\overset{3}{\sum}}\frac{\partial J_u}{\partial \chi_i} \chi_i - \lambda = 0, \; \begin{cases}
	\chi_1 = \cos{\alpha} \\
	\chi_2 = \cos{\beta} \\
	\chi_3 = \cos{\gamma}
\end{cases} \eqno(15)$$

Напомним известный термин и факт, связанный с ним: функция $f(x_1, \dots, x_n)$ называется **однородной степени $l$**, если она удовлетворяет уравнению:
$$f(\alpha x_1, \dots, \alpha x_n) = \alpha^l f (x_1, \dots, x_n) \eqno(16)$$
где $l$ - целое положительное число.

С однородными функциями связана следующая важная теорема (**соотношение Эйлера**): функция $f$ является однородной степени $l$ тогда и только тогда, когда выполняется следующее соотношение:
$$l \cdot f (x_1, \dots, x_n) = \underset{i=1}{\overset{n}{\sum}}\frac{\partial f}{\partial x_i} x_i\eqno(17)$$

Функция $J_u$ очевидно однородна, т.к. она полилинейна. По теореме Эйлера об однородных функциях из $(17)$ имеем:
$$J_u - \lambda = 0$$
т.е. значения множителя $\lambda_i$ совпадают со значениями
момента инерции $J_i$ ($i = 1,2,3$) относительно главных осей эллипсоида инерции тела в выбранной точке.

Если корни уравнения $(14)$ различны, то, подставляя
значения $\lambda$ в систему $(12)$, найдем для каждого $\lambda_i$ свой набор $\cos{\alpha}$, $\cos{\beta}$, $\cos{\gamma}$, который определяет соответствующее направление главной оси в выбранной системе координат $O_G XYZ$, и, соответственно, имеем трехосный эллипсоид инерции.

Если уравнение $(14)$ имеет два равных корня, то два главных момента инерции равны между собой, и эллипсоид инерции является эллипсоидом вращения.

В случае равенства всех корней уравнения $(14)$ эллипсоид инерции превращается в сферу (шаровой эллипсоид).

Таким образом, найденные собственные векторы и будут направлениями наших искомых главных центральных осей инерции, которые, как было указано выше, проходят через центр масс тела $G$.

<h3 align="left">Алгоритм проверки прямой на совпадение с главными центральными осями инерции</h3>

Примем без доказательства несколько интуитивно понятных физико-математических утверждений:
- Ось является главной осью инерции тогда и только тогда, когда она совпадает с одной из главных осей тензора инерции.
- Главной центральной осью инерции называется главная ось, проходящая через центр масс тела.
- Главная центральная ось инерции является главной осью для всех своих точек, а нецентральная главная ось инерции является главной осью лишь для одной своей точки.
- Если однородное абсолютно твердое тело имеет ось симметрии, то эта ось будет главной осью инерции для всех точек данной оси.
- Если однородное абсолютно твердое тело имеет плоскость симметрии, то для всех точек этой плоскости одна из главных осей инерции будет к ней перпендикулярна.

Таким образом, алгоритм проверки можно свести к относительно простой процедуре. 

Пусть мы имеем три оси, проходящие через центр масс тела (если они через него не проходят, то они не подходят уже по определению). Тогда мы берем любую точку на этих осях, не совпадающую с центром масс, и считаем тензоры инерции для этих точек. Если тензор инерции имеет диагональный вид, то ось, которой эта точка принадлежит, является правильно найденной главной центральной осью инерции, иначе - ошибка.













