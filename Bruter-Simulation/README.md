# Bruter Simulation
This repository contains bruter simulation project that have been done during my work.

<h2>Описание работы</h2>

Происходит обтачивание рундиста алмаза при одновременном вращении объекта и обдирочного диска.

Задача заключается в расчете оптимальной согласованной скорости вращения объекта и движения центра обдирочного диска.

Оптимальным считается движение при выполнении следующих условий:
- минимальное время обработки камня
- ускорения и скорости вращения и подачи диска не превышают заданных пределов механики
- выполняется ограничение на максимальный съем материала

Необходимо построить графики движения, скорости и ускорения диска, при условии что принцесса вращается равномерно, а диск скользит по поверхности рундиста принцессы.

<h2>Этапы моделирования</h2>

1) прицесса с квадратным рундистом и стороной 8mm, радиус диска 75mm, центр вращения бриллианта в центре бриллианта
2) то же самое что в п. 1, но центр смещен на 1 mm к одной стороне принцессы и на 2 mm к соседней стороне принцессы
3) то же самое что п. 2, но это не квадратная принцесса, а изумруд со сторонами 4 и 12 mm, и смещение центра вращения на 1 mm вдоль короткой стороны, а на 2 mm вдоль длинной
4) произвольный многогранник (здесь и выше, можно решать задачу в 2D) и произвольный центр вращения внутри многогранника
5) плавный переход из формы алмаза в форму бриллианта, чтобы максимизировать время контакта на один оборот и минимизировать максимальные ускорения: алмаз – это круг, а бриллиант – квадрат, тогда траектория плавно меняется с круга на квадрат

<h2>Решение</h2>
Будем моделировать задачу следующим образом: заданный многоугольник (сдвинутый или нет) вращается вокруг начала координат, диск находится всегда на оси OY и двигается по ней вверх и вниз.

<h3>Общая идея</h3>

- [ ] Строим скругленный контур вокруг заданного многоугольника – это геометрическое место центров окружности, катящейся без отрыва по границе исходного многоугольника. Есть два качественно разных участков данного контура:
	- [ ] диск касается стороны многоугольника, тогда эта часть контура будет являть собой прямую, параллельную касаемой стороне и отстоящей от нее на радиус диска
	- [ ] диск пересекает многоугольник по вершине, тогда эта часть контура будет являть собой окружность с центром в пересекаемой вершине и радиусом, равным радиусу диска
	
	Контур строится по точкам с большим числом разбиений.
- [ ] После получения контура вращаем его вокруг центра вращения (начала координат) и ищем точку пересечения этого контура с осью OY – ордината этой точки будет соответствовать углу поворота многоугольника, и мы получим зависимость ординаты центра диска от угла вращения
- [ ] Графики ординаты центра диска строим по точкам, а графики скорости и ускорения центра диска получаем численным дифференцированием (один и два раза) зависимости ординаты диска от угла поворота.

<h4>Идея для задачи №5</h4>

<h5>Бриллиант -> алмаз</h5>

В решении было использована кривая Фернандеса-Гуасти (т.н. squircle) – это плоская алгебраическая кривая, которая является промежуточной формой между кругом и квадратом. У нее есть качественные особенности, которые похожи на более известную кривую Ламе. Определения, свойства и формулы, использованные в алгоритме описаны в [статье](https://arxiv.org/pdf/1604.02174.pdf).

<img align="center" src="https://github.com/vkonov2/Geometry-Projects/blob/368df3c6b1f02d159556b4ee33a8953069cf5776/Bruter-Simulation/pics/squircle.png" alt="c" width="500" height="100"/>

<h5>Алмаз -> бриллиант</h5>

В решении было использована кривая Эдвардса – это плоская алгебраическая кривая, которая является важной кривой в области криптографии (для сложения на эллиптических кривых). Определения, свойства и формулы, использованные в алгоритме описаны в [статье](https://www.ams.org/journals/bull/2007-44-03/S0273-0979-07-01153-6/S0273-0979-07-01153-6.pdf).

<img align="center" src="https://github.com/vkonov2/Geometry-Projects/blob/368df3c6b1f02d159556b4ee33a8953069cf5776/Bruter-Simulation/pics/anim.gif" alt="c" width="400" height="400"/>

<h3>Реализация</h3>
Решение реализовано на языке Python. 
Для работы с геометрическими объектами, различных расчетов и графической презентацией данных были использованы библиотеки Shapely, PyPlot и Numpy.
Для анимации процесса “качения” диска по многоугольнику был реализован скрипт на языке Wolfram Mathematica.
Алгоритм построения произвольного многоугольника была реализована ранее.

<h2> Результаты расчетов </h2>

<h3> Модель №1 </h3>

<img align="center" src="https://github.com/vkonov2/Geometry-Projects/blob/368df3c6b1f02d159556b4ee33a8953069cf5776/Bruter-Simulation/pics/1-1.png" alt="c" width="400" height="400"/>

прицесса с квадратным рундистом и стороной 8mm, радиус диска 75mm, центр вращения бриллианта в центре бриллианта

<img align="center" src="https://github.com/vkonov2/Geometry-Projects/blob/368df3c6b1f02d159556b4ee33a8953069cf5776/Bruter-Simulation/pics/1-2.png" alt="c" width="400" height="400"/>

скругленный контур (красный) - это ГМТ центров катящейся окружности по границе квадрата

<img align="center" src="https://github.com/vkonov2/Geometry-Projects/blob/368df3c6b1f02d159556b4ee33a8953069cf5776/Bruter-Simulation/pics/1-3.png" alt="c" width="400" height="400"/>

графики координаты, скорости и ускорения центра диска от угла поворота камня

<h3> Модель №2 </h3>

<img align="center" src="https://github.com/vkonov2/Geometry-Projects/blob/368df3c6b1f02d159556b4ee33a8953069cf5776/Bruter-Simulation/pics/2-1.png" alt="c" width="400" height="400"/>

прицесса с квадратным рундистом и стороной 8mm, радиус диска 75mm, центр вращения бриллианта сдвинут на 1 mm к одной стороне принцессы и на 2 mm к соседней стороне принцессы

<img align="center" src="https://github.com/vkonov2/Geometry-Projects/blob/368df3c6b1f02d159556b4ee33a8953069cf5776/Bruter-Simulation/pics/2-2.png" alt="c" width="400" height="400"/>

скругленный контур (красный) - это ГМТ центров катящейся окружности по границе квадрата

<img align="center" src="https://github.com/vkonov2/Geometry-Projects/blob/368df3c6b1f02d159556b4ee33a8953069cf5776/Bruter-Simulation/pics/2-3.png" alt="c" width="400" height="400"/>

графики координаты, скорости и ускорения центра диска от угла поворота камня

<h3> Модель №3 </h3>

<img align="center" src="https://github.com/vkonov2/Geometry-Projects/blob/368df3c6b1f02d159556b4ee33a8953069cf5776/Bruter-Simulation/pics/3-1.png" alt="c" width="400" height="400"/>

изумруд со сторонами 4 и 12 mm, и смещение центра вращения на 1 mm вдоль короткой стороны, а на 2mm вдоль длинной

<img align="center" src="https://github.com/vkonov2/Geometry-Projects/blob/368df3c6b1f02d159556b4ee33a8953069cf5776/Bruter-Simulation/pics/3-2.png" alt="c" width="400" height="400"/>

скругленный контур (красный) - это ГМТ центров катящейся окружности по границе прямоугольника

<img align="center" src="https://github.com/vkonov2/Geometry-Projects/blob/368df3c6b1f02d159556b4ee33a8953069cf5776/Bruter-Simulation/pics/3-3.png" alt="c" width="400" height="400"/>

графики координаты, скорости и ускорения центра диска от угла поворота камня

<h3> Модель №4 </h3>

Модель генерации произвольного многоугольника: 
- задаем центр многоугольника
- создаем полигон по точкам выборки по окружности вокруг центра
- случайный шум добавляется путем изменения углового расстояния между соседними точками и радиального расстояние каждой точки от центра

Аргументы алгоритма построения произвольного многоугольника:
- центр: пара, представляющая центр используемой окружности для создания полигона
- средний радиус (расстояние каждой сгенерированной вершины до центра окружности), используемый для создания точек с нормальным распределением
- неравномерность: отклонение расстояния между углами между последовательными вершинами
- шиповатость: дисперсия расстояния каждой вершины до центра окружность
- количество вершин многоугольника

<img align="center" src="https://github.com/vkonov2/Geometry-Projects/blob/368df3c6b1f02d159556b4ee33a8953069cf5776/Bruter-Simulation/pics/4-1.png" alt="c" width="400" height="400"/>

произвольный многоугольник с центром (2, -1), средним радиусом 4, неравномерностью 0.05, шиповатостью 0.1 и 7 вершинами, радиус окружности равен 1.0

<img align="center" src="https://github.com/vkonov2/Geometry-Projects/blob/368df3c6b1f02d159556b4ee33a8953069cf5776/Bruter-Simulation/pics/4-2.png" alt="c" width="400" height="400"/>

скругленный контур - это ГМТ центров катящейся окружности

<img align="center" src="https://github.com/vkonov2/Geometry-Projects/blob/368df3c6b1f02d159556b4ee33a8953069cf5776/Bruter-Simulation/pics/4-3.png" alt="c" width="400" height="400"/>

графики координаты, скорости и ускорения центра диска от угла поворота камня





